name: dgreat
recipe: pantheon
config:
  framework: drupal8
  env: dev
  site: dgreat
  id: 41cad7fe-472d-43a9-a470-d391b9622376
services:
  appserver:
    overrides:
      services:
        environment:
            BEHAT_PARAMS: >-
              {
                  "extensions" : {
                      "Behat\\MinkExtension" : {
                          "base_url" : "http://nginx/"
                      }
                  }
              }
  node:
    type: node:6.10
    build:
      - "cd $LANDO_MOUNT/web/themes/custom/myusf && npm install && gulp"
    globals:
      gulp-cli: "latest"
  chromedriver:
    type: compose
    services:
      image: robcherry/docker-chromedriver:latest
      expose:
      - "4444"
      environment:
        CHROMEDRIVER_WHITELISTED_IPS: ""
        CHROMEDRIVER_URL_BASE: "/wd/hub"
        SCREEN_GEOMETRY: "1440x2000x24"
      security_opt:
      - seccomp:unconfined
      command: ["/usr/local/bin/supervisord", "-c", "/etc/supervisord.conf"]

tooling:
  npm:
    service: node
  gulp:
    service: node
  robo:
    service: appserver
    cmd: /app/vendor/bin/robo
  test:
    service: appserver
    cmd:
      - /app/vendor/bin/robo
      - test
  drush:
    service: appserver
    cmd:
      - drush
      - --uri=https://dgreat.lndo.site
  drupal:
    service: appserver
    cmd: /app/vendor/bin/drupal
